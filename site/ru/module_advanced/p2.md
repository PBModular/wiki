# üíΩ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ë–î

**–í –±–æ—Ç–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ORM SQLAlchemy –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ.** [**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**](https://docs.sqlalchemy.org/en/20/)

:::warning
–ü—Ä–µ–∂–¥–µ —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ë–î, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ `use_db` –∏–ª–∏ `require_db` –≤ —Ñ–∞–π–ª `info.yaml`!
:::

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ë–î –º–æ–¥—É–ª—å –¥–æ–ª–∂–µ–Ω –æ–±—ä—è–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π SQLAlchemy, –∞ –ø–æ–∑–∂–µ —É–∫–∞–∑–∞—Ç—å –æ–±—ä–µ–∫—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ property-–º–µ—Ç–æ–¥–µ `db_meta`:

### –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ú–æ–¥–µ–ª–µ–π

```python
# db.py
from sqlalchemy.orm import Mapped, mapped_column, DeclarativeBase

class Base(DeclarativeBase):
    pass
...

# main.py
from .db import Base
...
# Override db_meta method
@property
def db_meta(self):
    return Base.metadata
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –∞—Ç—Ä–∏–±—É—Ç–µ `db` –æ–±—ä–µ–∫—Ç–∞ –º–æ–¥—É–ª—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –æ–±—ä–µ–∫—Ç `Database`. –≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã:

- `engine` - –û–±—ä–µ–∫—Ç —Ç–∏–ø–∞ `AsyncEngine` (SQLAlchemy), –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∫–æ–º–∞–Ω–¥.
- `session_maker` - –û–±—ä–µ–∫—Ç —Ç–∏–ø–∞ `async_sessionmaker` (SQLAlchemy), –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç—ã —Å–µ—Å—Å–∏–π –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

::: info
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤–æ—è –ë–î. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite, –æ–¥–Ω–∞–∫–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ –±–æ—Ç–∞ (–ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ)
:::

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–î–∞–ª–µ–µ –æ–ø–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ, –∫–∞–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ SQLAlchemy, –∏—Å–ø–æ–ª—å–∑—É—è –æ–±—ä–µ–∫—Ç—ã `engine` –∏ `session_maker`. –ü—Ä–∏–º–µ—Ä:

```python
async with self.db.session_maker() as session:
    result = await session.scalar(select(User))
```
